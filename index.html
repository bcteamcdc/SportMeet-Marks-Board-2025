<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>InterHouse Sports Scores 2026</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="responsive.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <link rel="icon" type="image/png" sizes="32x32"
    href="https://i.ibb.co/x8H49CbB/New-Project-1-1.png">
  <!-- Chart.js Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>

<body>
  <div class="container">
    <header>
      <div class="header-brand">
        <div class="brand-logos">
          <div class="profile-icon"></div>
          <div class="club-icon"></div>
        </div>
        <div class="brand-info">
          <div class="header-title">InterHouse Sports 2026</div>
          <div class="header-subtitle">Live Scores & Rankings</div>
        </div>
      </div>
      <nav class="header-nav" role="navigation" aria-label="Main navigation">
        <a class="nav-tab" id="leaderboard-tab" title="Leaderboard" aria-label="Leaderboard">
          <i class="fas fa-trophy" aria-hidden="true"></i>
          <span>Leaderboard</span>
        </a>
        <a class="nav-tab" id="scores-tab" title="Scores" aria-label="Scores">
          <i class="fas fa-chart-bar" aria-hidden="true"></i>
          <span>Scores</span>
        </a>
        <a class="nav-tab" id="moments-tab" title="Moments" aria-label="Moments">
          <i class="fas fa-camera" aria-hidden="true"></i>
          <span>Moments</span>
        </a>
        <a class="nav-tab" id="analytics-tab" title="Analytics" aria-label="Analytics">
          <i class="fas fa-chart-line" aria-hidden="true"></i>
          <span>Analytics</span>
        </a>
      </nav>
    </header>
    
    <div class="loading-screen" id="loadingScreen">
      <div class="loader-container">
        <div class="circular-loader">
          <div class="loader-ring ring-1"></div>
          <div class="loader-ring ring-2"></div>
          <div class="loader-ring ring-3"></div>
          <div class="loader-center"></div>
        </div>
      </div>
      <div class="loader-progress-container">
        <div class="loader-progress-bar">
          <div class="loader-progress-fill" id="progressFill"></div>
        </div>
        <div class="loader-progress-text" id="progressText">0%</div>
      </div>
      <div class="loading-status" id="loadingStatus">LOADING...</div>
    </div>

    <!-- Leaderboard Page -->
    <div id="leaderboard-page" class="page" style="display: none;">
      <div class="page-title">
        <span class="page-title-icon"><i class="fas fa-star"></i></span>
        <span>Overall House Rankings 2026</span>
      </div>
      <div class="rankings-grid" id="rankings-container"></div>
      <br><br>
      <!-- App Download Section -->
      <div class="app-download-section">
        <div class="app-section-header">
          <h2 class="app-section-title"><i class="fas fa-mobile-alt"></i> Download Mobile App</h2>
          <p class="app-section-subtitle">Get the InterHouse Sports Scores 2026 mobile app for real-time updates and offline access</p>
        </div>

        <div class="app-files-grid">
          <div class="app-file-card">
            <div class="file-icon-container apk-icon">
              <div class="file-icon"><i class="fab fa-android"></i></div>
            </div>
            <div class="file-info">
              <div class="file-name">InterHouse Sports Score 2026</div>
              <span class="file-extension">.APK</span>
              <div class="file-details">
                <span class="file-size">12.5 MB</span>
                <span class="file-version">v1.0.2</span>
              </div>
              <a href="https://mega.nz/file/WBtQ1CpC#R2hqT7YiFWmJdnDv8HFIDJC60Np4kSzqul72g9dGwEc" class="download-button">
                <i class="fas fa-download"></i>
                Download for Android
              </a>
            </div>
          </div>
        </div>
      </div>

      <div class="coding-club-section">
        <div class="section-header">
          <h2 class="section-title">
            <i class="fas fa-code title-icon"></i>
            Coding Club Official Hub
          </h2>
          <p class="section-subtitle">Connecting Innovation, Code, and Community</p>
          <p class="section-description">
            Explore our digital ecosystem where coding excellence meets creative innovation. 
            Connect with us across multiple platforms and discover the latest in technology, 
            programming tutorials, and collaborative projects.
          </p>
        </div>

        <div class="club-content-grid">
          <div class="website-card">
            <div class="card-header">
              <div class="card-icon">
                <i class="fas fa-globe"></i>
              </div>
              <div>
                <h3 class="card-title">Official Website</h3>
                <p class="card-subtitle">Your gateway to digital excellence</p>
              </div>
            </div>

            <a href="https://teamcdc.netlify.app" class="website-link" target="_blank">
              <i class="fas fa-external-link-alt"></i>
              Visit teamcdc.netlify.app
            </a>

            <ul class="website-features">
              <li class="feature-item">
                <i class="fas fa-globe feature-icon"></i>
                Bandaranayake College Gampaha Coding Club
              </li>
              <li class="feature-item">
                <i class="fas fa-rocket feature-icon"></i>
                Latest project showcases and portfolios
              </li>
              <li class="feature-item">
                <i class="fas fa-calendar-alt feature-icon"></i>
                Event schedules and workshop announcements
              </li>
              <li class="feature-item">
                <i class="fas fa-file-alt feature-icon"></i>
                Blog posts & articles (Blog section)
              </li>
              <li class="feature-item">
                <i class="fas fa-users feature-icon"></i>
                Top Members / Leaders (Leaders page)
              </li>
            </ul>
          </div>

          <div class="social-card">
            <div class="card-header">
              <div class="card-icon">
                <i class="fas fa-share-alt"></i>
              </div>
              <div>
                <h3 class="card-title">Social Networks</h3>
                <p class="card-subtitle">Connect with our community</p>
              </div>
            </div>

            <div class="social-platforms">
              <a href="https://whatsapp.com/channel/0029Vb8DCeW0bIddkcNUZ51J" target="_blank" class="social-platform whatsapp">
                <div class="social-icon">
                  <i class="fab fa-whatsapp"></i>
                </div>
                <div class="social-name">WhatsApp</div>
                <div class="social-handle">Channel Updates</div>
              </a>

              <a href="https://facebook.com/bandaranayakecollege" target="_blank" class="social-platform facebook">
                <div class="social-icon">
                  <i class="fab fa-facebook-f"></i>
                </div>
                <div class="social-name">Facebook</div>
                <div class="social-handle">@bandaranayakecollege</div>
              </a>

              <a href="https://www.instagram.com/teamcdcbc?igsh=d2RkbTVvMXl5aTRk" target="_blank" class="social-platform instagram">
                <div class="social-icon">
                  <i class="fab fa-instagram"></i>
                </div>
                <div class="social-name">Instagram</div>
                <div class="social-handle">@teamcdcbc</div>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Scores Page -->
    <div id="scores-page" class="page">
      <div class="page-title">
        <span class="page-title-icon"><i class="fas fa-chart-bar"></i></span>
        <span>Sports Scores 2026</span>
      </div>
      <div class="sports-grid" id="sports-container"></div>
    </div>

    <!-- Winning Moments Page -->
    <div id="moments-page" class="page" style="display: none;">
      <div class="page-title">
        <span class="page-title-icon"><i class="fas fa-camera"></i></span>
        <span>Winning Moments 2026</span>
      </div>
      <!-- Image Slideshow -->
      <div class="slideshow-container" id="slideshow-container"></div>
      <div class="slideshow-controls" id="slideshow-controls"></div>
      <br>
      <!-- Moments Grid -->
      <div class="moments-grid" id="moments-container"></div>
      
      <!-- Photo Credits -->
      <div class="photo-credits">
        <i class="fas fa-camera"></i>
        <span>All photos copyrights goes to Bandaranayake College Photographic Art Society</span>
      </div>
    </div>
    
    <!-- House Details Page -->
    <div id="house-details-page" class="page" style="display: none;">
      <button class="back-button" id="back-to-leaderboard">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        Back to Leaderboard
      </button>
      <div class="page-title">
        <span class="page-title-icon"><i class="fas fa-home"></i></span>
        <span id="house-details-title">House Details</span>
      </div>
      <div class="sports-grid" id="house-sports-container"></div>
    </div>

    <!-- Athletics Details Page -->
    <div id="athletics-details-page" class="page" style="display: none;">
      <button class="back-button" id="back-to-scores">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        Back to Sports
      </button>
      <div class="page-title">
        <span class="page-title-icon"><i class="fas fa-running"></i></span>
        <span>Athletics Details</span>
      </div>
      <div class="athletics-container" id="athletics-container"></div>
    </div>

    <!-- Analytics Dashboard Page -->
    <div id="analytics-page" class="page" style="display: none;">
      <div class="page-title">
        <span class="page-title-icon"><i class="fas fa-chart-line"></i></span>
        <span>Performance Analytics</span>
      </div>
      
      <!-- Section 1: Current Year Analytics (2026) -->
      <div class="analytics-section">
        <div class="hcard">
          <div class="hcard-header">
            <div class="hcard-title-wrapper">
              <i class="fas fa-calendar-check hcard-icon"></i>
              <h2 class="hcard-title">Current Year Analytics - 2026</h2>
            </div>
            <p class="hcard-subtitle">View detailed performance for the current year</p>
          </div>
          
          <!-- Current Year Stats Cards -->
          <div class="analytics-stats-grid" id="current-year-stats">
            <div class="analytics-stat-card stat-total">
              <div class="stat-icon"><i class="fas fa-trophy"></i></div>
              <div class="stat-content">
                <div class="stat-value" id="stat-leader">--</div>
                <div class="stat-label">Current Leader</div>
              </div>
            </div>
            <div class="analytics-stat-card stat-points">
              <div class="stat-icon"><i class="fas fa-star"></i></div>
              <div class="stat-content">
                <div class="stat-value" id="stat-total-points">--</div>
                <div class="stat-label">Total Points</div>
              </div>
            </div>
            <div class="analytics-stat-card stat-sports">
              <div class="stat-icon"><i class="fas fa-medal"></i></div>
              <div class="stat-content">
                <div class="stat-value" id="stat-sports-count">--</div>
                <div class="stat-label">Sports Completed</div>
              </div>
            </div>
            <div class="analytics-stat-card stat-years">
              <div class="stat-icon"><i class="fas fa-calendar-alt"></i></div>
              <div class="stat-content">
                <div class="stat-value">2026</div>
                <div class="stat-label">Current Year</div>
              </div>
            </div>
          </div>
          
          <!-- Current Year Total Points Chart -->
          <div class="chart-container">
            <h3 class="chart-title"><i class="fas fa-chart-bar"></i> Total Points by House</h3>
            <canvas id="current-year-chart"></canvas>
          </div>
          
          <!-- Sport by Sport Breakdown -->
          <div class="chart-container sport-breakdown-container">
            <h3 class="chart-title"><i class="fas fa-futbol"></i> Sport by Sport Scores</h3>
            <div class="sport-filter-buttons" id="sport-filter-buttons">
              <!-- Buttons will be populated by JavaScript -->
            </div>
            <div class="sport-chart-wrapper">
              <canvas id="sport-breakdown-chart"></canvas>
            </div>
          </div>
          
          <!-- House Rankings Table -->
          <div class="house-rankings-table" id="house-rankings-table">
            <table class="rankings-table">
              <thead>
                <tr>
                  <th>Rank</th>
                  <th>House</th>
                  <th>Total Points</th>
                  <th>Top Sport</th>
                </tr>
              </thead>
              <tbody id="rankings-table-body">
              </tbody>
            </table>
          </div>
        </div>
      </div>
      
      <!-- Section 2: Historical Performance Comparison -->
      <div class="analytics-section">
        <div class="hcard">
          <div class="hcard-header">
            <div class="hcard-title-wrapper">
              <i class="fas fa-chart-area hcard-icon"></i>
              <h2 class="hcard-title">Historical Performance Comparison</h2>
            </div>
            <p class="hcard-subtitle">Compare house performance across years with interactive filters</p>
          </div>
          
          <!-- Filter Controls -->
          <div class="filters-grid">
            <div class="filter-group">
              <div class="filter-label-container">
                <label class="filter-label">House</label>
                <div class="tooltip">
                  <span class="tooltip-icon">?</span>
                  <span class="tooltip-text">Select a specific house or view all houses together</span>
                </div>
              </div>
              <div class="filter-options" id="house-options">
                <div class="filter-option active" data-value="All Houses">All Houses</div>
                <div class="filter-option gemunu-option" data-value="Gemunu">Gemunu</div>
                <div class="filter-option vijaya-option" data-value="Vijaya">Vijaya</div>
                <div class="filter-option parakrama-option" data-value="Parakrama">Parakrama</div>
                <div class="filter-option tissa-option" data-value="Tissa">Tissa</div>
              </div>
            </div>
            
            <div class="filter-group">
              <div class="filter-label-container">
                <label class="filter-label">Sport</label>
                <div class="tooltip">
                  <span class="tooltip-icon">?</span>
                  <span class="tooltip-text">Filter by specific sport or view overall performance</span>
                </div>
              </div>
              <div class="filter-options" id="sport-options">
                <div class="filter-option active" data-value="All Sports">Overall</div>
                <div class="filter-option" data-value="bestHouseDesign">Best House Design</div>
                <div class="filter-option" data-value="karate">Karate</div>
                <div class="filter-option" data-value="tableTennis">Table Tennis</div>
                <div class="filter-option" data-value="hardball">HardBall</div>
                <div class="filter-option" data-value="wrestling">Wrestling</div>
                <div class="filter-option" data-value="boxing">Boxing</div>
                <div class="filter-option" data-value="football">Football</div>
                <div class="filter-option" data-value="athletics">Athletics</div>
                <div class="filter-option" data-value="swimming">Swimming</div>
                <div class="filter-option" data-value="tagRugby">Tag Rugby</div>
                <div class="filter-option" data-value="roadRace">Road Race</div>
                <div class="filter-option" data-value="badminton">Badminton</div>
                <div class="filter-option" data-value="chess">Chess</div>
                <div class="filter-option" data-value="volleyball">Volleyball</div>
                <div class="filter-option" data-value="elle">Elle</div>
                <div class="filter-option" data-value="hockey">Hockey</div>
                <div class="filter-option" data-value="softball">Softball</div>
                <div class="filter-option" data-value="basketball">Basketball</div>
              </div>
            </div>
            
          </div>
          
          <!-- Chart Type Toggle -->
          <div class="filter-group">
            <label class="filter-label">Chart Type</label>
            <div class="chart-type-toggle">
              <button id="line-chart-btn" class="toggle-btn ">Line Chart</button>
              <button id="bar-chart-btn" class="toggle-btn active">Bar Chart</button>
            </div>
          </div>
          
          <!-- Chart Container -->
          <div class="chart-container">
            <canvas id="performance-chart"></canvas>
          </div>
          
          <!-- Chart Description -->
          <div class="chart-footer" id="chart-description">
            This chart shows the performance of all houses in overall points over the last 5 years.
          </div>
        </div>
      </div>
    </div>

    
<footer class="footer">
  <div class="footer-container">
    <div class="footer-center">
     
    </div>

  </div>

  <div class="footer-socials">
    <a href="https://whatsapp.com/channel/0029Vb8DCeW0bIddkcNUZ51J" target="_blank" class="social-icon whatsapp" title="WhatsApp">
      <i class="fab fa-whatsapp"></i>
    </a>
    <a href="https://facebook.com/bandaranayakecollege" target="_blank" class="social-icon facebook" title="Facebook">
      <i class="fab fa-facebook-f"></i>
    </a>
    <a href="https://www.instagram.com/teamcdcbc?igsh=d2RkbTVvMXl5aTRk" target="_blank" class="social-icon instagram" title="Instagram">
      <i class="fab fa-instagram"></i>
    </a>
  </div>

  <div class="footer-bottom">
<span>Â© 2026 Bandaranayake College <a class="officialweblink" href="https://teamcdc.netlify.app">Coding Club</a>. All rights reserved.</span><br>
     <span class="last-updated">Last Updated: <span id="last-update-date">Dec 04, 2025</span></span>
  </div>
</footer>
  </div>

  <!-- Import Historical and Moments Data -->
  <script src="historical.js"></script>
  <script src="moments.js"></script>
  
  <script>
window.addEventListener("load", () => {
  const progressFill = document.getElementById("progressFill");
  const progressText = document.getElementById("progressText");
  const loadingStatus = document.getElementById("loadingStatus");
  
  const statusMessages = [
    "LOADING...",
    "PREPARING DATA...",
    "ALMOST READY..."
  ];
  
  let progress = 0;
  const totalDuration = 2000;
  const interval = 30;
  const increment = 100 / (totalDuration / interval);
  
  const progressInterval = setInterval(() => {
    progress += increment + (Math.random() * 2);
    if (progress > 100) progress = 100;
    
    progressFill.style.width = progress + "%";
    progressText.textContent = Math.floor(progress) + "%";
    
    if (progress < 40) {
      loadingStatus.textContent = statusMessages[0];
    } else if (progress < 75) {
      loadingStatus.textContent = statusMessages[1];
    } else {
      loadingStatus.textContent = statusMessages[2];
    }
    
    if (progress >= 100) {
      clearInterval(progressInterval);
      setTimeout(() => {
        document.getElementById("loadingScreen").classList.add("hidden");
      }, 300);
    }
  }, interval);
});

    // DOM Elements - Navigation and Pages
    const scoresTab = document.getElementById('scores-tab');
    const leaderboardTab = document.getElementById('leaderboard-tab');
    const momentsTab = document.getElementById('moments-tab');
    const analyticsTab = document.getElementById('analytics-tab');
    
    const scoresPage = document.getElementById('scores-page');
    const leaderboardPage = document.getElementById('leaderboard-page');
    const momentsPage = document.getElementById('moments-page');
    const analyticsPage = document.getElementById('analytics-page');
    const houseDetailsPage = document.getElementById('house-details-page');
    const athleticsDetailsPage = document.getElementById('athletics-details-page');
    
    // DOM Elements - Containers
    const sportsContainer = document.getElementById('sports-container');
    const rankingsContainer = document.getElementById('rankings-container');
    const momentsContainer = document.getElementById('moments-container');
    const houseSportsContainer = document.getElementById('house-sports-container');
    const athleticsContainer = document.getElementById('athletics-container');
    const slideshowContainer = document.getElementById('slideshow-container');
    const slideshowControls = document.getElementById('slideshow-controls');
    
    // DOM Elements - Buttons and Titles
    const houseDetailsTitle = document.getElementById('house-details-title');
    const backButton = document.getElementById('back-to-leaderboard');
    const backToScoresButton = document.getElementById('back-to-scores');
    
    // Slideshow Variables
    let currentSlide = 0;
    let slideshowInterval;
    const slideshowDelay = 2000;

    // Page Navigation Functions
    function showPage(pageElement) {
      // Hide all pages
      const allPages = [scoresPage, leaderboardPage, momentsPage, analyticsPage, houseDetailsPage, athleticsDetailsPage];
      allPages.forEach(page => page.style.display = 'none');
      
      // Show selected page
      pageElement.style.display = 'block';
      
      // Handle slideshow for moments page
      if (pageElement === momentsPage) {
        startSlideshow();
      } else {
        stopSlideshow();
      }
      
      // Initialize chart for analytics page
      if (pageElement === analyticsPage) {
        initChart();
      }
    }

    function setActiveTab(tab) {
      // Remove active class from all tabs
      const allTabs = [scoresTab, leaderboardTab, momentsTab, analyticsTab];
      allTabs.forEach(t => t.classList.remove('active'));
      
      // Set active tab
      tab.classList.add('active');
    }

    // Navigation Event Listeners
    scoresTab.addEventListener('click', () => {
      showPage(scoresPage);
      setActiveTab(scoresTab);
    });

    leaderboardTab.addEventListener('click', () => {
      showPage(leaderboardPage);
      setActiveTab(leaderboardTab);
      renderRankings();
    });

    momentsTab.addEventListener('click', () => {
      showPage(momentsPage);
      setActiveTab(momentsTab);
    });

    analyticsTab.addEventListener('click', () => {
      showPage(analyticsPage);
      setActiveTab(analyticsTab);
    });

    // Back Button Event Listeners
    backButton.addEventListener('click', () => {
      showPage(leaderboardPage);
      setActiveTab(leaderboardTab);
    });

    backToScoresButton.addEventListener('click', () => {
      showPage(scoresPage);
      setActiveTab(scoresTab);
    });

    // Sports Rendering Functions
    function getMaxScore(scores) {
      return Math.max(...scores.map(item => item.score));
    }

    function renderSports() {
      sportsContainer.innerHTML = '';

      sportsData.sports.forEach(sport => {
        const maxScore = getMaxScore(sport.scores);
        const sportCard = document.createElement('div');
        sportCard.className = 'sport-card';
        
        // Add click event for Athletics card
        if (sport.id === "Athletics") {
          sportCard.dataset.sport = "Athletics";
          sportCard.addEventListener('click', () => showAthleticsDetails());
        }

        let sportContent = `
        <div class="sport-header">
          <div class="sport-title">${sport.name}</div>
          <div class="sport-subtitle">${sport.venue}</div>
          <div class="sport-date">${sport.date}</div>
          ${sport.isLive ? '<div class="live-tag"><div class="live-indicator"></div>LIVE</div>' : ''}
        </div>
        `;

        // Add scores for each house
        sport.scores.forEach(score => {
          const percentage = (score.score / maxScore) * 100;
          sportContent += `
          <div class="score-item">
            <div class="score-row">
              <div class="house-name ${score.house.toLowerCase()}">${score.house}</div>
              <div class="house-score">${score.score}</div>
            </div>
            <div class="progress-container">
              <div class="progress-bar ${score.house.toLowerCase()}" style="width: ${percentage}%"></div>
            </div>
          </div>
          `;
        });
        
        // Add details link for Athletics
        if (sport.id === "Athletics") {
          sportContent += `
          <div class="see-more-btn">
            <span class="see-more-text">View Details</span>
            <span class="see-more-icon"><i class="fas fa-arrow-right"></i></span>
          </div>
          `;
        }

        sportCard.innerHTML = sportContent;
        sportsContainer.appendChild(sportCard);
      });
    }

    // Rankings Functions
function calculateTotalPoints() {
      const houses = {
        "Vijaya": {
          total: 0,
          color: "vijaya"
        },
        "Tissa": {
          total: 0,
          color: "tissa"
        },
        "Gemunu": {
          total: 0,
          color: "gemunu"
        },
        "Parakrama": {
          total: 0,
          color: "parakrama"
        }
      };

      sportsData.sports.forEach(sport => {
        sport.scores.forEach(score => {
          houses[score.house].total += score.score;
        });
      });

      return Object.entries(houses)
        .map(([name, data]) => ({
          name,
          total: data.total,
          color: data.color
        }))
        .sort((a, b) => b.total - a.total);
    }

    function renderRankings() {
      const rankings = calculateTotalPoints();
      rankingsContainer.innerHTML = '';

      rankings.forEach((house, index) => {
        const rankCard = document.createElement('div');
        rankCard.className = `ranking-card ${house.color}-card ${index === 0 ? 'highlighted' : ''}`;
        rankCard.dataset.house = house.name;
        rankCard.addEventListener('click', () => showHouseDetails(house.name));

        rankCard.innerHTML = `
        <div class="rank-number">Rank #${index + 1}</div>
        <div class="house-ranking ${house.color}">
          <span class="house-icon"><i class="fas fa-home"></i></span>
          <span>${house.name}</span>
        </div>
        <div class="total-score">${house.total}</div>
        `;

        rankingsContainer.appendChild(rankCard);
      });
    }

    // House Details Functions
    function showHouseDetails(houseName) {
      showPage(houseDetailsPage);
      houseDetailsTitle.textContent = `${houseName} House Details`;
      renderHouseSports(houseName);
    }

    function renderHouseSports(houseName) {
      houseSportsContainer.innerHTML = '';

      // Filter sports for selected house
      const houseSports = sportsData.sports.map(sport => ({
        ...sport,
        scores: sport.scores.filter(score => score.house === houseName)
      })).filter(sport => sport.scores.length > 0);

      houseSports.forEach(sport => {
        const sportCard = document.createElement('div');
        sportCard.className = 'sport-card';

        let sportContent = `
        <div class="sport-header">
          <div class="sport-title">${sport.name}</div>
          <div class="sport-subtitle">${sport.venue}</div>
          <div class="sport-date">${sport.date}</div>
        </div>
        `;

        sport.scores.forEach(score => {
          sportContent += `
          <div class="score-item">
            <div class="score-row">
              <div class="house-name ${score.house.toLowerCase()}">${score.house}</div>
              <div class="house-score">${score.score}</div>
            </div>
          </div>
          `;
        });

        sportCard.innerHTML = sportContent;
        houseSportsContainer.appendChild(sportCard);
      });
    }

    // Athletics Details Functions
    function showAthleticsDetails() {
      showPage(athleticsDetailsPage);
      renderAthleticsDetails();
    }

    function renderAthleticsDetails() {
      athleticsContainer.innerHTML = '';
      
      athleticsData.categories.forEach(category => {
        const categoryGroup = document.createElement('div');
        categoryGroup.className = 'category-group';
        
        const categoryHeader = document.createElement('div');
        categoryHeader.className = 'category-header';
        categoryHeader.textContent = category.name;
        categoryGroup.appendChild(categoryHeader);
        
        const categoryEvents = document.createElement('div');
        categoryEvents.className = 'category-events';
        
        category.events.forEach(event => {
          const eventCard = document.createElement('div');
          eventCard.className = 'event-card';
          
          const maxScore = Math.max(...event.scores.map(item => item.score));
          
          // Build event card HTML like sport card
          let eventContent = `
            <div class="event-header">
              <div class="event-name">${event.name}</div>
              ${event.location ? `<div class="event-location">${event.location}</div>` : ''}
              ${event.date ? `<div class="event-date">${event.date}</div>` : ''}
            </div>
          `;
          
          // Add scores for each house (same as sport card)
          event.scores.forEach(score => {
            const percentage = maxScore > 0 ? (score.score / maxScore) * 100 : 0;
            eventContent += `
              <div class="score-item">
                <div class="score-row">
                  <div class="house-name ${score.house.toLowerCase()}">${score.house}</div>
                  <div class="house-score">${score.score}</div>
                </div>
                <div class="progress-container">
                  <div class="progress-bar ${score.house.toLowerCase()}" style="width: ${percentage}%"></div>
                </div>
              </div>
            `;
          });
          
          eventCard.innerHTML = eventContent;
          categoryEvents.appendChild(eventCard);
        });
        
        categoryGroup.appendChild(categoryEvents);
        athleticsContainer.appendChild(categoryGroup);
      });
    }

    // Slideshow Functions
    function createSlideshow() {
      slideshowContainer.innerHTML = '';
      slideshowControls.innerHTML = '';
      
      // Create wrapper for slides
      const wrapper = document.createElement('div');
      wrapper.className = 'slideshow-wrapper';
      
      momentsData.moments.forEach((moment, index) => {
        const slide = document.createElement('div');
        slide.className = `slideshow-slide ${index === 0 ? 'active' : ''}`;
        
        const imagePath = moment.image || `/api/placeholder/800/400`;
        const houseColor = moment.house.toLowerCase();
        
        slide.innerHTML = `
          <img src="${imagePath}" alt="${moment.title}" class="slideshow-image">
          <span class="moment-house-badge ${houseColor}">${moment.house}</span>
          <div class="slideshow-caption">
            <div class="slideshow-title">${moment.title}</div>
            <div class="slideshow-description">${moment.description}</div>
          </div>
        `;
        
        wrapper.appendChild(slide);
        
        const indicator = document.createElement('div');
        indicator.className = `slideshow-indicator ${index === 0 ? 'active' : ''}`;
        indicator.dataset.slideIndex = index;
        indicator.addEventListener('click', () => {
          goToSlide(index);
        });
        
        slideshowControls.appendChild(indicator);
      });
      
      // Add arrow buttons
      const prevArrow = document.createElement('button');
      prevArrow.className = 'slideshow-arrow prev';
      prevArrow.innerHTML = '<i class="fas fa-chevron-left"></i>';
      prevArrow.addEventListener('click', () => prevSlide());
      
      const nextArrow = document.createElement('button');
      nextArrow.className = 'slideshow-arrow next';
      nextArrow.innerHTML = '<i class="fas fa-chevron-right"></i>';
      nextArrow.addEventListener('click', () => nextSlide());
      
      slideshowContainer.appendChild(wrapper);
      slideshowContainer.appendChild(prevArrow);
      slideshowContainer.appendChild(nextArrow);
    }

    function goToSlide(index) {
      const slides = document.querySelectorAll('.slideshow-slide');
      const indicators = document.querySelectorAll('.slideshow-indicator');
      
      // Remove all classes
      slides.forEach((slide, i) => {
        slide.classList.remove('active', 'prev', 'next');
        if (i < index) slide.classList.add('prev');
        if (i > index) slide.classList.add('next');
      });
      indicators.forEach(indicator => indicator.classList.remove('active'));
      
      // Add active class
      slides[index].classList.add('active');
      indicators[index].classList.add('active');
      
      currentSlide = index;
      resetSlideshowTimer();
    }

    function nextSlide() {
      const slides = document.querySelectorAll('.slideshow-slide');
      const nextIndex = (currentSlide + 1) % slides.length;
      goToSlide(nextIndex);
    }

    function prevSlide() {
      const slides = document.querySelectorAll('.slideshow-slide');
      const prevIndex = (currentSlide - 1 + slides.length) % slides.length;
      goToSlide(prevIndex);
    }

    function startSlideshow() {
      if (!slideshowInterval) {
        slideshowInterval = setInterval(nextSlide, slideshowDelay);
      }
    }

    function stopSlideshow() {
      if (slideshowInterval) {
        clearInterval(slideshowInterval);
        slideshowInterval = null;
      }
    }

    function resetSlideshowTimer() {
      stopSlideshow();
      startSlideshow();
    }

    // Moments Functions
    function renderMoments() {
      momentsContainer.innerHTML = '';
      
      momentsData.moments.forEach(moment => {
        const momentCard = document.createElement('div');
        momentCard.className = 'moment-card';
       
        const imagePath = moment.image || `/api/placeholder/400/200`;
        const houseColor = moment.house.toLowerCase();
        
        const albumBtn = moment.album ? 
          `<a href="${moment.album}" target="_blank" class="moment-album-icon" title="View Album">
            <i class="fas fa-images"></i>
          </a>` : '';
        
        const viewAlbumBtn = moment.album ? 
          `<a href="${moment.album}" target="_blank" class="moment-cta-btn">
            <span>View Album</span>
            <i class="fas fa-arrow-right"></i>
          </a>` : '';
        
        momentCard.innerHTML = `
          <div class="moment-image-wrapper">
            <img src="${imagePath}" alt="${moment.title}" class="moment-image" loading="lazy">
            <div class="moment-image-overlay"></div>
            <div class="moment-image-shine"></div>
            <span class="moment-house-badge ${houseColor}">${moment.house}</span>
            ${albumBtn}
          </div>
          <div class="moment-content">
            <div class="moment-sport-tag">
              <i class="fas fa-trophy"></i>
              <span>Winning Moment</span>
            </div>
            <h3 class="moment-title">${moment.title}</h3>
            <p class="moment-description">${moment.description}</p>
            <div class="moment-actions">
              ${viewAlbumBtn}
            </div>
          </div>
        `;
        
        momentsContainer.appendChild(momentCard);
      });
    }

    // Analytics Chart Functions
    const houseColors = {
      'Gemunu': '#2563EB',
      'Vijaya': '#DC2626', 
      'Parakrama': '#FBBF24',
      'Tissa': '#16A34A'
    };

    // Chart Variables
    const houseOptions = document.getElementById('house-options');
    const sportOptions = document.getElementById('sport-options');
    const lineChartBtn = document.getElementById('line-chart-btn');
    const barChartBtn = document.getElementById('bar-chart-btn');
    const chartDescription = document.getElementById('chart-description');
    const chartCanvas = document.getElementById('performance-chart');

    let performanceChart = null;
    let currentState = {
      selectedHouse: "All Houses",
      selectedSport: "All Sports",
      chartType: "bar"
    };

    // Filter Options Handler
    function setupFilterOptions(container, stateKey) {
      const options = container.querySelectorAll('.filter-option');
      
      options.forEach(option => {
        option.addEventListener('click', () => {
          options.forEach(opt => opt.classList.remove('active'));
          option.classList.add('active');
          currentState[stateKey] = option.dataset.value;
          updateChartData();
          updateDescription();
        });
      });
    }

    // Initialize Chart
    function initChart() {
      setupFilterOptions(houseOptions, 'selectedHouse');
      setupFilterOptions(sportOptions, 'selectedSport');
      updateChartData();
      updateDescription();
    }

    // Transform Data for Chart - uses all available years dynamically
    function transformData() {
      // Use all available years from historicalData (sorted ascending)
      const sortedData = [...historicalData].sort((a, b) => a.year - b.year);
      const labels = sortedData.map(item => item.year);
      const datasets = [];
      
      const houses = currentState.selectedHouse === "All Houses" 
        ? ["Gemunu", "Vijaya", "Parakrama", "Tissa"] 
        : [currentState.selectedHouse];
      
      houses.forEach(house => {
        const data = sortedData.map(yearData => {
          return currentState.selectedSport === "All Sports"
            ? yearData[house].total
            : yearData[house][currentState.selectedSport] || 0;
        });
        
        datasets.push({
          label: house,
          data: data,
          backgroundColor: houseColors[house] + '80',
          borderColor: houseColors[house],
          borderWidth: 2,
          tension: 0.4,
          fill: false
        });
      });
      
      return { labels, datasets };
    }

    // Update Chart Data
    function updateChartData() {
      const chartData = transformData();
      
      if (performanceChart) {
        performanceChart.destroy();
      }
      
      const ctx = chartCanvas.getContext('2d');
      performanceChart = new Chart(ctx, {
        type: currentState.chartType,
        data: chartData,
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'top',
              labels: {
                color: '#ffffff',
                font: {
                  size: 12
                }
              }
            },
            tooltip: {
              mode: 'index',
              intersect: false,
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              titleColor: '#ffffff',
              bodyColor: '#ffffff',
              borderColor: '#ffffff',
              borderWidth: 1
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: 'Year',
                color: '#ffffff',
                font: {
                  size: 14,
                  weight: 'bold'
                }
              },
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                color: '#ffffff'
              }
            },
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Points',
                color: '#ffffff',
                font: {
                  size: 14,
                  weight: 'bold'
                }
              },
              grid: {
                color: 'rgba(255, 255, 255, 0.1)'
              },
              ticks: {
                color: '#ffffff'
              }
            }
          },
          interaction: {
            intersect: false,
            mode: 'index'
          }
        }
      });
    }

    // Update Chart Description
    function updateDescription() {
      const houseText = currentState.selectedHouse === "All Houses" 
        ? "performance of all houses" 
        : `${currentState.selectedHouse} house's performance`;
      
      const sportText = currentState.selectedSport === "All Sports" 
        ? "overall points" 
        : currentState.selectedSport;
      
      // Calculate years dynamically from historicalData
      const years = historicalData.map(item => item.year).sort((a, b) => a - b);
      const yearCount = years.length;
      const timeText = yearCount === 1 
        ? `year ${years[0]}` 
        : `${yearCount} years (${years[0]}-${years[years.length - 1]})`;
      
      chartDescription.textContent = `This chart shows the ${houseText} in ${sportText} over ${timeText}.`;
    }

    barChartBtn.addEventListener('click', () => {
      currentState.chartType = 'bar';
      barChartBtn.classList.add('active');
      lineChartBtn.classList.remove('active');
      updateChartData();
    });
    // Chart Type Toggle Event Listeners
    lineChartBtn.addEventListener('click', () => {
      currentState.chartType = 'line';
      lineChartBtn.classList.add('active');
      barChartBtn.classList.remove('active');
      updateChartData();
    });


    // Update Analytics Stats (uses current data from sportsData)
    function updateAnalyticsStats() {
      const rankings = calculateTotalPoints();
      const leader = rankings[0];
      const totalPoints = rankings.reduce((sum, house) => sum + house.total, 0);
      const sportsCount = sportsData.sports.length;
      
      const leaderEl = document.getElementById('stat-leader');
      const totalPointsEl = document.getElementById('stat-total-points');
      const sportsCountEl = document.getElementById('stat-sports-count');
      
      if (leaderEl) leaderEl.textContent = leader.name;
      if (totalPointsEl) totalPointsEl.textContent = totalPoints.toLocaleString();
      if (sportsCountEl) sportsCountEl.textContent = sportsCount;
    }

    // Current Year Analytics Variables
    let currentYearChart = null;
    let sportBreakdownChart = null;
    const currentYear = 2026;
    let yearDataCache = {};
    let current2026Data = null;
    const currentYearChartCanvas = document.getElementById('current-year-chart');
    const sportBreakdownChartCanvas = document.getElementById('sport-breakdown-chart');
    const rankingsTableBody = document.getElementById('rankings-table-body');
    const sportFilterButtons = document.getElementById('sport-filter-buttons');
    let selectedSport = '';

    // Load Year Data from JSON
    async function loadYearData(year) {
      if (yearDataCache[year]) {
        return yearDataCache[year];
      }
      
      try {
        const response = await fetch(`data/${year}.json`);
        if (!response.ok) {
          throw new Error(`Failed to load ${year}.json`);
        }
        const data = await response.json();
        yearDataCache[year] = data;
        return data;
      } catch (error) {
        console.error(`Error loading data for year ${year}:`, error);
        return null;
      }
    }

    // Populate Sport Filter Buttons from 2026.json sports array
    function populateSportFilterButtons(yearData) {
      if (!sportFilterButtons || !yearData.sports) return;
      
      sportFilterButtons.innerHTML = '';
      
      // Add "All Sports" button first
      const allBtn = document.createElement('button');
      allBtn.className = 'sport-filter-btn active';
      allBtn.dataset.sport = '';
      allBtn.textContent = 'All';
      allBtn.addEventListener('click', () => handleSportFilter('', yearData));
      sportFilterButtons.appendChild(allBtn);
      
      yearData.sports.forEach(sport => {
        const btn = document.createElement('button');
        btn.className = 'sport-filter-btn';
        btn.dataset.sport = sport.id;
        btn.textContent = sport.name;
        btn.addEventListener('click', () => handleSportFilter(sport.id, yearData));
        sportFilterButtons.appendChild(btn);
      });
    }
    
    // Handle Sport Filter Button Click
    function handleSportFilter(sportId, yearData) {
      selectedSport = sportId;
      
      // Update active state
      const buttons = sportFilterButtons.querySelectorAll('.sport-filter-btn');
      buttons.forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.sport === sportId) {
          btn.classList.add('active');
        }
      });
      
      updateSportBreakdownChart(yearData, sportId);
    }

    // Update Current Year Analytics (always 2026)
    async function updateCurrentYearAnalytics() {
      const yearData = await loadYearData(currentYear);
      
      if (!yearData) {
        console.error('No data available for 2026');
        return;
      }
      
      current2026Data = yearData;
      updateCurrentYearStats(yearData);
      updateCurrentYearChart(yearData);
      populateSportFilterButtons(yearData);
      updateSportBreakdownChart(yearData, '');
      updateRankingsTable(yearData);
    }

    // Get 2026 historical data from global historicalData array
    function get2026HistoricalData() {
      const data2026 = historicalData.find(item => item.year === 2026);
      return data2026 || null;
    }

    // Update Current Year Stats Cards
    function updateCurrentYearStats(yearData) {
      const data2026 = get2026HistoricalData();
      const houses = ['Gemunu', 'Vijaya', 'Parakrama', 'Tissa'];
      
      let rankings = houses.map(house => ({
        name: house,
        total: data2026 && data2026[house] ? data2026[house].total : 0
      }));
      
      rankings.sort((a, b) => b.total - a.total);
      
      const leader = rankings[0];
      const totalPoints = rankings.reduce((sum, house) => sum + house.total, 0);
      const sportsCount = yearData.sports ? yearData.sports.length : 0;
      
      document.getElementById('stat-leader').textContent = leader.name;
      document.getElementById('stat-total-points').textContent = totalPoints.toLocaleString();
      document.getElementById('stat-sports-count').textContent = sportsCount;
    }

    // Update Current Year Chart
    function updateCurrentYearChart(yearData) {
      if (!currentYearChartCanvas) return;
      
      const data2026 = get2026HistoricalData();
      const houses = ['Gemunu', 'Vijaya', 'Parakrama', 'Tissa'];
      
      const labels = houses;
      const totals = houses.map(house => data2026 && data2026[house] ? data2026[house].total : 0);
      
      if (currentYearChart) {
        currentYearChart.destroy();
      }
      
      const ctx = currentYearChartCanvas.getContext('2d');
      currentYearChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: `Total Points 2026`,
            data: totals,
            backgroundColor: [
              houseColors['Gemunu'] + '80',
              houseColors['Vijaya'] + '80',
              houseColors['Parakrama'] + '80',
              houseColors['Tissa'] + '80'
            ],
            borderColor: [
              houseColors['Gemunu'],
              houseColors['Vijaya'],
              houseColors['Parakrama'],
              houseColors['Tissa']
            ],
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              titleColor: '#ffffff',
              bodyColor: '#ffffff'
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: 'House',
                color: '#ffffff',
                font: { size: 14, weight: 'bold' }
              },
              grid: { color: 'rgba(255, 255, 255, 0.1)' },
              ticks: { color: '#ffffff' }
            },
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Total Points',
                color: '#ffffff',
                font: { size: 14, weight: 'bold' }
              },
              grid: { color: 'rgba(255, 255, 255, 0.1)' },
              ticks: { color: '#ffffff' }
            }
          }
        }
      });
    }

    // Update Sport Breakdown Chart - shows individual sport scores when selected
    function updateSportBreakdownChart(yearData, selectedSportId) {
      if (!sportBreakdownChartCanvas) return;
      
      const houses = ['Gemunu', 'Vijaya', 'Parakrama', 'Tissa'];
      
      if (sportBreakdownChart) {
        sportBreakdownChart.destroy();
      }
      
      // If no sport selected, show message
      if (!selectedSportId) {
        const ctx = sportBreakdownChartCanvas.getContext('2d');
        ctx.clearRect(0, 0, sportBreakdownChartCanvas.width, sportBreakdownChartCanvas.height);
        ctx.fillStyle = '#ffffff';
        ctx.font = '16px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('Select a sport from the dropdown to view scores', sportBreakdownChartCanvas.width / 2, sportBreakdownChartCanvas.height / 2);
        return;
      }
      
      // Find the selected sport from sports array
      const selectedSport = yearData.sports.find(sport => sport.id === selectedSportId);
      
      if (!selectedSport) {
        console.error('Sport not found:', selectedSportId);
        return;
      }
      
      // Get scores for each house from the sports array
      const scores = houses.map(house => {
        const houseScore = selectedSport.scores.find(s => s.house === house);
        return houseScore ? houseScore.score : 0;
      });
      
      const ctx = sportBreakdownChartCanvas.getContext('2d');
      sportBreakdownChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: houses,
          datasets: [{
            label: selectedSport.name,
            data: scores,
            backgroundColor: houses.map(house => houseColors[house] + '80'),
            borderColor: houses.map(house => houseColors[house]),
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false
            },
            title: {
              display: true,
              text: `${selectedSport.name} - House Scores`,
              color: '#ffffff',
              font: { size: 16, weight: 'bold' }
            },
            tooltip: {
              backgroundColor: 'rgba(0, 0, 0, 0.8)',
              titleColor: '#ffffff',
              bodyColor: '#ffffff'
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: 'House',
                color: '#ffffff',
                font: { size: 14, weight: 'bold' }
              },
              grid: { color: 'rgba(255, 255, 255, 0.1)' },
              ticks: { color: '#ffffff' }
            },
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Points',
                color: '#ffffff',
                font: { size: 14, weight: 'bold' }
              },
              grid: { color: 'rgba(255, 255, 255, 0.1)' },
              ticks: { color: '#ffffff' }
            }
          }
        }
      });
    }

    // Update Rankings Table
    function updateRankingsTable(yearData) {
      if (!rankingsTableBody) return;
      
      const data2026 = get2026HistoricalData();
      const houses = ['Gemunu', 'Vijaya', 'Parakrama', 'Tissa'];
      
      let rankings = houses.map(house => {
        const houseData = data2026 && data2026[house] ? data2026[house] : {};
        const sportsScores = Object.entries(houseData).filter(([key]) => key !== 'total');
        let topSport = { name: 'N/A', score: 0 };
        
        sportsScores.forEach(([sport, score]) => {
          if (score > topSport.score) {
            topSport = { name: formatSportName(sport), score: score };
          }
        });
        
        return {
          name: house,
          total: houseData.total || 0,
          topSport: topSport.name
        };
      });
      
      rankings.sort((a, b) => b.total - a.total);
      
      rankingsTableBody.innerHTML = rankings.map((house, index) => `
        <tr>
          <td>#${index + 1}</td>
          <td>${house.name}</td>
          <td>${house.total.toLocaleString()}</td>
          <td>${house.topSport}</td>
        </tr>
      `).join('');
    }

    // Format Sport Name
    function formatSportName(sport) {
      const sportNames = {
        'bestHouseDesign': 'Best House Design',
        'karate': 'Karate',
        'tableTennis': 'Table Tennis',
        'hardball': 'Hardball',
        'wrestling': 'Wrestling',
        'boxing': 'Boxing',
        'football': 'Football',
        'athletics': 'Athletics',
        'swimming': 'Swimming',
        'tagRugby': 'Tag Rugby',
        'roadRace': 'Road Race',
        'badminton': 'Badminton',
        'chess': 'Chess',
        'volleyball': 'Volleyball',
        'elle': 'Elle',
        'hockey': 'Hockey',
        'softball': 'Softball',
        'basketball': 'Basketball'
      };
      return sportNames[sport] || sport;
    }

    // Initialize Current Year Analytics (2026 only)
    async function initCurrentYearAnalytics() {
      await updateCurrentYearAnalytics();
    }
    
    // Global data variables (loaded from JSON)
    let sportsData = { sports: [] };
    let athleticsData = { categories: [] };
    
    // Load data from JSON file
    async function loadSportsData() {
      try {
        const response = await fetch('data/2026.json');
        if (!response.ok) {
          throw new Error('Failed to load 2026.json');
        }
        const data = await response.json();
        sportsData = { sports: data.sports || [] };
        athleticsData = { categories: data.athletics?.categories || [] };
        return data;
      } catch (error) {
        console.error('Error loading sports data:', error);
        return null;
      }
    }
    
    // Initialize Application
    async function initializeApp() {
      await loadSportsData();
      renderSports();
      renderRankings();
      renderMoments();
      createSlideshow();
      updateAnalyticsStats();
      initCurrentYearAnalytics();
      initChart();
      showPage(leaderboardPage);
      setActiveTab(leaderboardTab);
    }

    // Start the application when DOM is loaded
    document.addEventListener('DOMContentLoaded', initializeApp);

  </script>
</body>

</html>
